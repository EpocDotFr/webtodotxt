<!DOCTYPE html>
<html lang="{{ g.CURRENT_LOCALE }}">
<head>
    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow,noarchive"/>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.5.1/css/pikaday.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">

    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" />

    <title>Web Todo.txt</title>
</head>
<body>
    <div id="app">
        <header class="row">
            <div class="title"><a href="{{ request.url_root }}"><img src="{{ url_for('static', filename='favicon.png') }}"> Web Todo.txt</a>
                <small v-show="loading" class="muted"><i class="fa fa-spinner fa-pulse"></i> {{ _('Loading...') }}</small>
            </div>
            <div class="menu">
                <button @click="addTodo()" :disabled="loading"><i class="fa fa-plus"></i> {{ _('Add') }}</button>
                <button @click="loadTodoTxt()" :disabled="loading"><i class="fa fa-refresh"></i> {{ _('Reload') }}</button>
                <button @click="saveTodoTxt()" :disabled="loading"><i class="fa fa-floppy-o"></i> {{ _('Save') }}</button>
            </div>
        </header>
        <div id="content" class="row">
            <div id="filters">
                <div>
                    <h2>{{ _('General filters') }} <button class="small" @click="clearGeneralFilters()" title="{{ _('Clear these filters') }}"><i class="fa fa-eraser"></i></button></h2>

                    <div>{{ _('Completed:') }}
                        <label><input type="radio" v-model="filters.completed" value="all"> {{ _('All') }}</label>
                        <label><input type="radio" v-model="filters.completed" value="yes"> {{ _('Yes') }}</label>
                        <label><input type="radio" v-model="filters.completed" value="no"> {{ _('No') }}</label>
                    </div>
                    <div><input type="text" v-model="filters.text" placeholder="{{ _('Text') }}"></div>
                    <div><input type="text" placeholder="{{ _('Completion date') }}" class="date" readonly data-filter="completion_date"></div>
                    <div><input type="text" placeholder="{{ _('Creation date') }}" class="date" readonly data-filter="creation_date"></div>
                </div>
                <div class="lists">
                    <h2>{{ _('Priorities') }} <button class="small" @click="clearPrioritiesFilters()" title="{{ _('Clear these filters') }}"><i class="fa fa-eraser"></i></button></h2>

                    <div class="muted" v-show="allPriorities.length == 0">{{ _('None a this moment.') }}</div>
                    <div v-for="priority in allPriorities">
                        <label><input type="checkbox" v-model="filters.priorities" :value="priority"> <span :class="['priority-chip', priority]">${ priority }</span></label>
                    </div>
                </div>
                <div class="lists">
                    <h2>{{ _('Projects') }} <button class="small" @click="clearProjectsFilters()" title="{{ _('Clear these filters') }}"><i class="fa fa-eraser"></i></button></h2>

                    <div class="muted" v-show="allProjects.length == 0">{{ _('None a this moment.') }}</div>
                    <div v-for="project in allProjects">
                        <label><input type="checkbox" v-model="filters.projects" :value="project"> ${ project }</label>
                    </div>
                </div>
                <div class="lists">
                    <h2>{{ _('Contexts') }} <button class="small" @click="clearContextsFilters()" title="{{ _('Clear these filters') }}"><i class="fa fa-eraser"></i></button></h2>

                    <div class="muted" v-show="allContexts.length == 0">{{ _('None a this moment.') }}</div>
                    <div v-for="context in allContexts">
                        <label><input type="checkbox" v-model="filters.contexts" :value="context"> ${ context }</label>
                    </div>
                </div>
                <div class="bottom">
                    <button @click="clearAllFilters()"><i class="fa fa-eraser"></i> {{ _('Clear all filters') }}</button>
                </div>
            </div>
            <div id="todos">
                <div class="muted" v-show="filteredTodos.length == 0">{{ _('No todos to display') }} <i class="fa fa-smile-o"></i></div>
                <div v-for="todo in filteredTodos" :class="['todo', todo.completed ? 'completed' : '', todoBeingEdited == todo ? 'editing' : '']">
                    <div class="actions">
                        <a href="#" @click.prevent="cancelEditTodo(todo)" title="{{ _('Cancel') }}" class="cancel"><i class="fa fa-times fa-fw"></i></a>
                        <a href="#" @click.prevent="doneEditTodo(todo)" title="{{ _('Done') }}" class="apply"><i class="fa fa-check fa-fw"></i></a>
                        <a href="#" @click.prevent="editTodo(todo)" title="{{ _('Edit') }}" class="edit"><i class="fa fa-pencil fa-fw"></i></a>
                        <a href="#" @click.prevent="removeTodo(todo)" title="{{ _('Delete') }}"><i class="fa fa-trash fa-fw"></i></a>
                    </div>
                    <div class="row container show">
                        <div class="completed-checkbox">
                            <input type="checkbox" v-model="todo.completed">
                        </div>
                        <div class="priority" v-show="todo.priority"><span :class="['priority-chip', todo.priority]">${ todo.priority }</span></div>
                        <div class="content">
                            <div class="text">${ todo.text }</div>
                            <div class="metadata">
                                <template v-for="project in todo.projects">+${ project } </template>
                                <template v-for="context in todo.contexts">@${ context } </template>
                                <template v-if="todo.creation_date">{{ _('Created') }} ${ todo.creation_date.format('L') }</template>
                                <template v-if="todo.completion_date">{{ _('Completed') }} ${ todo.completion_date.format('L') }</template>
                            </div>
                        </div>
                    </div>
                    <div class="row container edit">
                        <div><input type="text" v-model="todo.text" @keyup.enter="doneEditTodo(todo)" @keyup.esc="cancelEditTodo(todo)" placeholder="{{ _('Type some text') }}"></div>
                        <div>Test</div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="muted">© 2016 <a href="https://epoc.fr">Maxime "Epoc" G.</a> • <a href="https://github.com/EpocDotFr/webtodotxt">{{ _('Source code on GitHub') }}</a> • {{ _('Licensed under the %(license)s', license='<a href="https://github.com/EpocDotFr/webtodotxt/blob/master/LICENSE.md">DBAD</a>'|safe) }}</footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
    <script src="https://unpkg.com/vue@2.1.0/dist/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.0/moment-with-locales.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.5.1/pikaday.min.js"></script>
    <script>
        ROOT_URL = '{{ request.url_root }}';

        moment.locale('{{ g.CURRENT_LOCALE }}');

        PIKADAY_LOCALE = {
            previousMonth : '{{ _('Previous Month') }}',
            nextMonth     : '{{ _('Next Month') }}',
            months        : [
                '{{ _('January') }}',
                '{{ _('February') }}',
                '{{ _('March') }}',
                '{{ _('April') }}',
                '{{ _('May') }}',
                '{{ _('June') }}',
                '{{ _('July') }}',
                '{{ _('August') }}',
                '{{ _('September') }}',
                '{{ _('October') }}',
                '{{ _('November') }}',
                '{{ _('December') }}'
            ],
            weekdays      : [
                '{{ _('Sunday') }}',
                '{{ _('Monday') }}',
                '{{ _('Tuesday') }}',
                '{{ _('Wednesday') }}',
                '{{ _('Thursday') }}',
                '{{ _('Friday') }}',
                '{{ _('Saturday') }}'
            ],
            weekdaysShort : [
                '{{ _('Sun') }}',
                '{{ _('Mon') }}',
                '{{ _('Tue') }}',
                '{{ _('Wed') }}',
                '{{ _('Thu') }}',
                '{{ _('Fri') }}',
                '{{ _('Sat') }}'
            ]
        };
    </script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>